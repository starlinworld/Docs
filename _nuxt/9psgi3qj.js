import{bG as H,bH as N,w as O,bI as W,G as j,H as G,bJ as T,bK as k,d as V,o as x,a as w,p as b,q as F,m as M,s as i,W as $,bL as Q,bM as X,c as S,_ as Z,$ as J,ae as L,av as K,e as A,B as y,bN as Y,F as ee,v as te,bO as R,bP as oe,bQ as z,bR as ne,a5 as q,f as B,a8 as D,bS as ae,aQ as ie,bT as se}from"./Jz-ouIsC.js";let le=0;function re(o){const t=new WeakMap,r=H();function c(n){if(o.mode!=="popLayout")return;const d=n.offsetParent,E=d instanceof HTMLElement&&d.offsetWidth||0,l={height:n.offsetHeight||0,width:n.offsetWidth||0,top:n.offsetTop,left:n.offsetLeft,right:0};l.right=E-l.width-l.left;const f=o.anchorX==="left"?`left: ${l.left}px`:`right: ${l.right}px`,h=`pop-${le++}`;n.dataset.motionPopId=h;const m=document.createElement("style");r.value.nonce&&(m.nonce=r.value.nonce),t.set(n,m),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
    [data-motion-pop-id="${h}"] {
      position: absolute !important;
      width: ${l.width}px !important;
      height: ${l.height}px !important;
      top: ${l.top}px !important;
      ${f} !important;
      }
      `)}function C(n){const d=t.get(n);d&&(t.delete(n),N.render(()=>{document.head.removeChild(d)}))}return{addPopStyle:c,removePopStyle:C}}function ue(o){const t=new Map,r=new Set,{addPopStyle:c,removePopStyle:C}=re(o);function n(e,s){let a=t.get(e);a||(a={motions:new Set,exitingMotions:new Set,el:e},t.set(e,a)),a.motions.add(s)}function d(e,s){const a=t.get(e);a&&(a.exitingMotions.delete(s),a.exitingMotions.size===0&&a.done&&m(a))}function E(e){r.add(e)}function l(e){r.delete(e)}const f={initial:o.initial,custom:o.custom,register:n,onMotionExitComplete:d,registerPending:E,unregisterPending:l};O(()=>o.custom,e=>{f.custom=e},{flush:"pre"}),W(f),j(()=>{f.initial=void 0});function h(e){if(e instanceof HTMLElement&&!e.hasAttribute(k)){e.setAttribute(k,"");const s=T.get(e);s&&!s.presenceContainer&&(s.presenceContainer=e,n(e,s))}}function m(e){var s,a,v,P,p;C(e.el),e.motions.forEach(u=>{u.getSnapshot(u.options,!1)}),(s=e.done)==null||s.call(e),e.done=void 0,(a=e.el)!=null&&a.isConnected?(P=(v=e.motions.values().next())==null?void 0:v.value)==null||P.didUpdate():(e.motions.forEach(u=>{u.unmount()}),e.motions.clear()),(p=o.onExitComplete)==null||p.call(o)}function _(e,s){h(e);const a=t.get(e);a&&(a.exitingMotions.clear(),a.motions.forEach(v=>{v.setActive("exit",!1),v.getSnapshot(v.options,!0)})),s()}function I(e,s){var a,v,P;const p=e;h(p),r.forEach(g=>{g.element&&p.contains(g.element)&&(g.presenceContainer=p,n(p,g),r.delete(g))});const u=t.get(p),U=T.get(p);if((!u||u.motions.size===0)&&!U){s(),(a=o.onExitComplete)==null||a.call(o);return}u.done=s,c(p),u.motions.forEach(g=>{u.exitingMotions.add(g),g.setActive("exit",!0),g.getSnapshot(g.options,!1)}),(P=(v=u.motions.values().next())==null?void 0:v.value)==null||P.didUpdate()}return G(()=>{t.forEach(e=>{e.motions.forEach(s=>{s.unmount()})}),t.clear()}),{enter:_,exit:I}}const ce=V({name:"AnimatePresence",inheritAttrs:!0,__name:"AnimatePresence",props:{mode:{default:"sync"},initial:{type:Boolean,default:!0},as:{},custom:{},onExitComplete:{},anchorX:{default:"left"}},setup(o){const t=o,{enter:r,exit:c}=ue(t),C=S(()=>t.mode!=="wait"?{tag:t.as}:{mode:t.mode==="wait"?"out-in":void 0});return(n,d)=>(x(),w($(n.mode==="wait"?Q:X),M(C.value,{appear:"",onLeave:i(c),onEnter:i(r)}),{default:b(()=>[F(n.$slots,"default")]),_:3},16,["onLeave","onEnter"]))}}),de={slots:{base:"rounded-md w-full",overlay:"fixed inset-0 bg-default/75 backdrop-blur-sm will-change-opacity",content:"fixed inset-0 flex items-center justify-center cursor-zoom-out focus:outline-none",zoomedImage:"w-full h-auto max-w-[95vw] max-h-[95vh] object-contain rounded-md"},variants:{zoom:{true:"will-change-transform"},open:{true:""}},compoundVariants:[{zoom:!0,open:!1,class:"cursor-zoom-in"}]},fe=["onClick"],pe=Object.assign({inheritAttrs:!1},{__name:"ProseImg",props:{src:{type:String,required:!0},alt:{type:String,required:!0},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},class:{type:null,required:!1},zoom:{type:Boolean,required:!1,default:!0},ui:{type:Object,required:!1}},setup(o){const t=o,r=Z(),c=J("prose.img",t),[C,n]=L(),[d,E]=L(),l=te(!1),f=S(()=>D({extend:D(de),...r.ui?.prose?.img||{}})({zoom:t.zoom,open:l.value})),h=S(()=>ae(t.src,ie().app.baseURL)),m=S(()=>`${h.value}::${se()}`);return t.zoom&&K(window,"scroll",()=>{l.value=!1}),(_,I)=>(x(),A(ee,null,[y(i(C),null,{default:b(()=>[(x(),w($(i(R)),M({src:h.value,alt:o.alt,width:o.width,height:o.height},_.$attrs,{class:f.value.base({class:[i(c)?.base,t.class]})}),null,16,["src","alt","width","height","class"]))]),_:1}),y(i(d),null,{default:b(()=>[(x(),w($(i(R)),M({src:h.value,alt:o.alt},_.$attrs,{class:f.value.zoomedImage({class:[i(c)?.zoomedImage]})}),null,16,["src","alt","class"]))]),_:1}),o.zoom?(x(),w(i(Y),{key:0,open:l.value,"onUpdate:open":I[0]||(I[0]=e=>l.value=e),modal:!1},{default:b(({close:e})=>[y(i(oe),{"as-child":""},{default:b(()=>[y(i(z),{"layout-id":m.value,"as-child":"",transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:b(()=>[y(i(n))]),_:1},8,["layout-id"])]),_:1}),y(i(ne),null,{default:b(()=>[y(i(ce),null,{default:b(()=>[l.value?(x(),w(i(z),{key:0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},class:q(f.value.overlay({class:[i(c)?.overlay]}))},null,8,["class"])):B("",!0),l.value?(x(),A("div",{key:1,class:q(f.value.content({class:[i(c)?.content]})),onClick:e},[y(i(z),{"as-child":"","layout-id":m.value,transition:{type:"spring",bounce:.15,duration:.5,ease:"easeInOut"}},{default:b(()=>[y(i(E))]),_:1},8,["layout-id"])],10,fe)):B("",!0)]),_:2},1024)]),_:2},1024)]),_:1},8,["open"])):(x(),w(i(n),{key:1}))],64))}});export{pe as default};
